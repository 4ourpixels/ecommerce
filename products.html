<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <title>Arap Trap - Shop</title>
    <link
    rel="icon"
    type="image/x-icon"
    sizes="32x32"
    href="./images/favicon.ico"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500&display=swap"
    rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./styles.css">
    <script src="https://www.paypal.com/sdk/js?client-id=AbxKJTrIe4cI0MpzJKtfFRWUS91uOXcZG7iil5_SB-gfLp24psCWUUSOkSRrm-qzFgKvwGpSWGjCHTuE&currency=USD"></script>
</head>
<body>
<!---- header ----->

    <div class="container">
        <div class="navbar">
            <div class="logo">
                <a href="index.html"><img height="50" width="auto" style="filter: invert();" src="./images/g400.png" width="125px"></a>
            </div>
            <nav>
                <ul id="MenuItems">
                    <li><a class="underline inherit" href="index.html">Home</li></a>
                    <li><a class="underline inherit" href="./products.html">Shop</li></a>
                    <li><a class="underline inherit" href="https://4ourpixels.github.io/4ourpixels/djg400.html">Mixes</li></a>
                </ul>
            </nav>
            <!-- Button trigger modal -->
            <button 
                id="cart-btn"
                class="text-black cart-btn"
                type="button"   
                data-bs-toggle="modal"
                data-bs-target="#cartModal"
            >
                <img src="./images/cart.png" width="30px" height="30px">
            </button>
            <img src="./images/menu.png" class="menu-icon" onclick="menutoggle()">
        </div>
    </div>
    <header id="banner"></header>

    <!-- Modal -->
    <div class="modal fade container-fluid" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="cartModalLabel">Your Cart Details</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- cart object goes here -->
                <table class="table table-responsive">
                    <small id="cart-message" class="text-primary"></small>
                    <thead>
                        <tr>
                        <th></th>
                        <th class="col text-black">Item</th>
                        <th class="col text-black">Quantity</th>
                        <th class="col text-black">Total</th>
                        </tr>
                    </thead>
                    <tbody id="cart-info">
                        
                    </tbody>
                </table>

                <div class="total-price">
                    <table class="w-100">
                        <tr>
                            <td>Total Items</td>
                            <td id="total-items-in-cart">0</td>
                        </tr>
                        <tr>
                            <td>Sub Total</td>
                            <td id="sub-total">$0.00</td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <button id="lipa-na-mpesa-btn" onclick="pay()">Lipa Na Mpesa</button>
                    <div id="paypal-button-container"></div>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
            </div>
        </div>
    </div>
    

    <div class="container">
        <h2 class="my-4">Showing All Products</h2>
        <select id="sortingOptions" onchange="sortProducts()">
            <option value="default">Sort By Default</option>
            <option value="popular">Popular</option>
            <option value="latest">Latest</option>
        </select>

        <div id="products" class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
            <!-- object goes here -->
        </div>
    </div>

    <!---- footer ----->
    <div class="footer">
        <p class="copyright mb3">Copyright &copy; <a style="color: inherit;" href="https://4ourpixels.github.io/4ourpixels/">4our Pixels</a> 2023</p>
    </div>

    <!---- js for toggle menu ----->

    <script src="./products.js"></script>
    <script src="./app.js"></script>

    <script>
        var MenuItems = document.getElementById("MenuItems");

        MenuItems.style.maxHeight = "0px";

        function menutoggle(){
            if(MenuItems.style.maxHeight == "0px")
            {
                MenuItems.style.maxHeight = "200px";
            }
            else
            {
                MenuItems.style.maxHeight = "0px";
            }
        }
    </script>

     <!-- Function to toggle the cart-details element -->
    <!-- <script>
        function toggleCartDetails() {
        var cartDetails = document.getElementById("cart-details");
        if (cartDetails.classList.contains("hidden")) {
            cartDetails.classList.remove("hidden");
        } else {
            cartDetails.classList.add("hidden");
        }
        }
        cartBtn.addEventListener("click", toggleCartDetails);

    </script> -->

    <script>
        const total = document.getElementById("sub-total").innerText;

        // Set up PayPal button
        paypal.Buttons({
        createOrder: function(data, actions) {
            // This function sets up the details of the transaction, including the order total and currency.
            return actions.order.create({
            purchase_units: [{
                amount: {
                value: total // Replace with the actual total order amount
                }
            }]
            });
        },
        onApprove: function(data, actions) {
            // This function captures the funds from the transaction.
            return actions.order.capture().then(function(details) {
            // This is where you can handle the successful payment. For example, you can display a success message, update the cart status, or redirect to a success page.
            console.log("Payment successful!");
            alert("Payment successful!");
            });
        },
        onError: function(err) {
            // This function handles errors that occur during the PayPal checkout process.
            console.error("An error occurred during checkout:", err);
        }
        }).render('#paypal-button-container');
    </script>
    <script>
        function pay(){
            var url = "https://tinypesa.com/api/v1/express/initialize";

            fetch(url, {
                body: "amount=1&msisdn=0712575797&account_no=400",
                headers: {
                    Apikey: "Me3s8tLM8vW",
                    "Content-Type": "application/x-www-form-urlencoded",
                },
                method: "POST",
            });
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>

</body>
</html>